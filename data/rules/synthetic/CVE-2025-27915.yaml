rules:
- id: synthetic-cve202527915
  languages:
  - javascript
  - typescript
  message: "Posible XSS al insertar directamente contenido de un archivo ICS (por\
    \ ejemplo, el campo DESCRIPTION) en HTML sin escape ni sanitizaci\xF3n. Un atacante\
    \ puede inyectar HTML/JS en el ICS (p.ej. DESCRIPTION:<div ontoggle=\"alert(1)\"\
    ></div>) que se renderiza en el navegador, explotando CVE-2025-27915. Valida,\
    \ escapa o sanitiza el contenido antes de interpolarlo en plantillas HTML.\n"
  severity: ERROR
  metadata:
    cve: CVE-2025-27915
    source: CISA_KEV
    category: security
    technology:
    - nodejs
    - express
    cwe: CWE-79
    likelihood: MEDIUM
    impact: HIGH
    confidence: MEDIUM
    owasp: A03:2021 - Injection
    references:
    - https://cwe.mitre.org/data/definitions/20.html
  patterns:
  - pattern-either:
    - pattern: "fs.readFile($ICS_PATH, ..., (err, $DATA) => {\n  ...\n});\n"
    - pattern: '$DATA = fs.readFileSync($ICS_PATH, ...);

        '
  - pattern-inside: 'const $APP = require(''express'')(...);

      ...

      '
  - pattern-inside: "$APP.get($ROUTE, ($REQ, $RES) => {\n  ...\n  $FUNC(..., (err,\
      \ $DATA) => {\n    ...\n    $HTML = `... ${$DESC} ...`;\n    ...\n    $RES.setHeader('Content-Type',\
      \ 'text/html' , ...);\n    $RES.send($HTML);\n  });\n});\n"
  - pattern-either:
    - pattern: '$MATCH = $DATA.match(/DESCRIPTION:(.*)/);

        $DESC = $MATCH ? $MATCH[1] : $FALLBACK;

        '
    - pattern: '$DESC = $DATA.match(/DESCRIPTION:(.*)/)[1];

        '
  - pattern-not: '$SAFE_DESC = $SANITIZE($DESC);

      '
  - pattern-not: $HTML = $ESCAPE($DESC);
