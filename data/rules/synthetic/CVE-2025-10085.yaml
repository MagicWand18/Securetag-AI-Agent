rules:
- id: synthetic-cve202510085
  languages:
  - javascript
  - typescript
  severity: ERROR
  message: "Posible vulnerabilidad de subida de archivos sin validaci\xF3n en un directorio\
    \ p\xFAblico (CVE-2025-10085). El archivo subido se guarda directamente en una\
    \ ruta accesible desde la web sin comprobar tipo, extensi\xF3n ni tama\xF1o, lo\
    \ que permite a un atacante subir contenido malicioso (por ejemplo, scripts o\
    \ archivos ejecutables) y acceder a ellos mediante una URL p\xFAblica.\n"
  metadata:
    cve: CVE-2025-10085
    source: CISA_KEV
    category: insecure-file-upload
    likelihood: high
    impact: high
    references:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-10085
    technology:
    - javascript
    - typescript
    - nodejs
    confidence: MEDIUM
    cwe: 'CWE-20: Improper Input Validation'
    owasp: A03:2021 - Injection
  patterns:
  - pattern-either:
    - pattern: "$APP.$METHOD($ROUTE, ... , (req, res, ... ) => {\n  ...\n  if (!req.files\
        \ || !req.files.$F) {\n    ...\n  }\n  ...\n  const $UPLOADED = req.files.$F;\n\
        \  ...\n  const $UPLOAD_DIR = $PATH.join(..., 'public', ...);\n  ...\n  const\
        \ $UPLOAD_PATH = $PATH.join($UPLOAD_DIR, $UPLOADED.name);\n  ...\n  $UPLOADED.mv($UPLOAD_PATH,\
        \ ...);\n  ...\n  res.$SEND(`File uploaded successfully: ${$PUBLIC_URL}`);\n\
        })\n"
    - pattern: "$APP.$METHOD($ROUTE, ... , (req, res, ... ) => {\n  ...\n  const $UPLOADED\
        \ = req.files.$F;\n  ...\n  const $UPLOAD_DIR = $PATH.join(..., 'public',\
        \ ...);\n  ...\n  const $UPLOAD_PATH = $PATH.join($UPLOAD_DIR, $UPLOADED.name);\n\
        \  ...\n  $UPLOADED.mv($UPLOAD_PATH, ...);\n  ...\n  res.$SEND($RESP);\n})\n"
  fix: "Valida estrictamente el tipo MIME, extensi\xF3n y tama\xF1o del archivo antes\
    \ de guardarlo, utiliza listas blancas de extensiones permitidas y evita almacenar\
    \ archivos subidos directamente en directorios servidos p\xFAblicamente. En su\
    \ lugar, usa rutas no p\xFAblicas y genera nombres de archivo seguros."
