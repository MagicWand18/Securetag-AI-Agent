rules:
- id: synthetic-cve202013927
  languages:
  - javascript
  - typescript
  message: "Esta ruta HTTP expone una API \"experimental\" de orquestaci\xF3n de tareas\
    \ sin ning\xFAn tipo de autenticaci\xF3n o autorizaci\xF3n, lo que permite a un\
    \ atacante remoto listar, disparar o modificar tareas de forma no autenticada.\
    \ Esto es an\xE1logo a CVE-2020-13927 (Apache Airflow Experimental REST API expuesta\
    \ sin autenticaci\xF3n), que ha mostrado alta probabilidad de explotaci\xF3n en\
    \ entornos reales. Aseg\xFArate de proteger estos endpoints con autenticaci\xF3\
    n/autorizaci\xF3n robusta o deshabilitarlos en producci\xF3n.\n"
  severity: ERROR
  metadata:
    cve: CVE-2020-13927
    source: CISA_KEV
    category: security
    technology:
    - express
    cwe:
    - 'CWE-306: Missing Authentication for Critical Function'
    references:
    - https://nvd.nist.gov/vuln/detail/CVE-2020-13927
    likelihood: MEDIUM
    impact: HIGH
    confidence: MEDIUM
    owasp: A03:2021 - Injection
  patterns:
  - pattern-inside: 'const $APP = require(''express'');

      ...

      const $INSTANCE = $APP(...);

      ...

      $INSTANCE.$USE($MW);

      ...

      '
  - pattern-either:
    - pattern: "$INSTANCE.get('/api/experimental/tasks', ($REQ, $RES) => {\n  ...\n\
        });\n"
    - pattern: "$INSTANCE.post('/api/experimental/tasks/:$TASKID/trigger', ($REQ,\
        \ $RES) => {\n  ...\n});\n"
    - pattern: "$INSTANCE.put('/api/experimental/tasks/:$TASKID/config', ($REQ, $RES)\
        \ => {\n  ...\n});"
