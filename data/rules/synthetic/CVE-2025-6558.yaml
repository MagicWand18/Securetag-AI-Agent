rules:
- id: synthetic-cve20256558
  languages:
  - javascript
  - typescript
  severity: ERROR
  message: "Posible explotaci\xF3n similar a CVE-2025-6558: entrada controlada por\
    \ el atacante se inyecta directamente en HTML/JavaScript y, en el mismo flujo,\
    \ se usa sin validaci\xF3n para construir un comando de sistema con `exec`. Este\
    \ patr\xF3n crea un puente entre datos de renderizado (p.ej. shaders/HTML din\xE1\
    mico) y una capa nativa/externa (GPU worker, procesos auxiliares), permitiendo\
    \ inyecci\xF3n de contenido arbitrario en el contexto de la p\xE1gina y potencial\
    \ ejecuci\xF3n de comandos. Valida/escapa la entrada y evita concatenar par\xE1\
    metros no sanitizados en comandos de shell.\n"
  metadata:
    cve: CVE-2025-6558
    source: CISA_KEV
    category: security
    technology:
    - nodejs
    - express
    likelihood: HIGH
    impact: HIGH
    confidence: MEDIUM
    cwe: 'CWE-20: Improper Input Validation'
    owasp: A03:2021 - Injection
    references:
    - https://cwe.mitre.org/data/definitions/20.html
  patterns:
  - pattern: "$APP.$METHOD($ROUTE, ($REQ, $RES) => {\n  ...\n})\n"
  - metavariable-pattern:
      metavariable: $METHOD
      pattern-either:
      - pattern: post
      - pattern: put
      - pattern: all
  - pattern-inside: "$APP.$METHOD($ROUTE, ($REQ, $RES) => {\n  const { $SHADER, $GPUFLAG,\
      \ ...$REST } = $REQ.body;\n  ...\n})\n"
  - pattern-either:
    - pattern: "const $HTML = `\n  ...\n  ${$SHADER}\n  ...\n`;\n"
    - pattern: "let $HTML = `\n  ...\n  ${$SHADER}\n  ...\n`;\n"
  - pattern-either:
    - pattern: "const { exec } = require('child_process');\n...\nconst $CMD = `...\
        \ ${$GPUFLAG} ...`;\nexec($CMD, ($ERR, $STDOUT, $STDERR) => {\n  ...\n});\n"
    - pattern: "const child_process = require('child_process');\n...\nconst $CMD =\
        \ `... ${$GPUFLAG} ...`;\nchild_process.exec($CMD, ($ERR, $STDOUT, $STDERR)\
        \ => {\n  ...\n});\n"
  - metavariable-comparison:
      metavariable: $SHADER
      comparison: $SHADER != $GPUFLAG
