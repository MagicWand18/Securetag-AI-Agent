rules:
- id: synthetic-cve202510115
  languages:
  - javascript
  - typescript
  message: "Posible SQL Injection (CVE-2025-10115): se construye din\xE1micamente\
    \ una consulta SQL concatenando directamente par\xE1metros controlados por el\
    \ usuario (por ejemplo, req.query.name o req.query.username) en la cadena de la\
    \ consulta antes de pas\xE1rsela a db.query(). Un atacante puede inyectar payloads\
    \ como `admin' OR '1'='1` para alterar la l\xF3gica de la consulta, extraer datos\
    \ sensibles o modificar la base de datos. Use consultas parametrizadas/preparadas\
    \ en lugar de concatenar cadenas.\n"
  severity: ERROR
  metadata:
    cve: CVE-2025-10115
    source: CISA_KEV
    category: security
    technology:
    - nodejs
    - express
    - mysql
    vulnerability: sql-injection
    likelihood: MEDIUM
    impact: HIGH
    confidence: MEDIUM
    cwe: 'CWE-89: Improper Neutralization of Special Elements used in an SQL Command'
    owasp: A03:2021 - Injection
    references:
    - https://cwe.mitre.org/data/definitions/20.html
  patterns:
  - pattern-either:
    - patterns:
      - pattern: '$DB = require(''mysql2'');

          ...

          $CONN = $DB.$CREATECONNECTION(...);

          ...

          $SQL = "...";

          ...

          $SQL += $X;

          ...

          $CONN.query($SQL, ...);

          '
      - pattern-inside: "app.$METHOD($ROUTE, ($REQ, $RES, ...) => {\n  ...\n})\n"
      - pattern-either:
        - pattern-inside: 'const $NAME = $REQ.query.$PARAM;

            ...

            '
        - pattern-inside: 'let $NAME = $REQ.query.$PARAM;

            ...

            '
        - pattern-inside: 'var $NAME = $REQ.query.$PARAM;

            ...

            '
      - pattern: $SQL += "..." + $NAME + "...";
    - patterns:
      - pattern-inside: "app.$METHOD($ROUTE, ($REQ, $RES, ...) => {\n  ...\n})\n"
      - pattern: $CONN.query("..." + $REQ.query.$PARAM + "...", ...);
