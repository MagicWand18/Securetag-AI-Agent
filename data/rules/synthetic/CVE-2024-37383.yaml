rules:
- id: synthetic-cve202437383
  languages:
  - javascript
  - typescript
  severity: ERROR
  message: "Posible vulnerabilidad similar a CVE-2024-37383: contenido SVG controlado\
    \ por el usuario se inserta directamente en una respuesta HTML sin sanitizaci\xF3\
    n. Esto puede permitir la inyecci\xF3n de elementos/atributos SVG peligrosos (por\
    \ ejemplo, <animate>, onbegin, etc.) y conducir a XSS o ejecuci\xF3n de c\xF3\
    digo en el navegador. Valida y sanitiza estrictamente cualquier SVG antes de incrustarlo\
    \ en HTML.\n"
  patterns:
  - pattern-inside: "$APP.$METHOD($ROUTE, ($REQ, $RES) => {\n  ...\n})\n"
  - pattern: "const $HTML = `\n  ...\n  ${$SVG}\n  ...\n`;\n"
  - pattern: '$RES.send($HTML)

      '
  - pattern-either:
    - pattern: '$SVG = $REQ.query.$PARAM

        '
    - pattern: '$SVG = $REQ.body.$PARAM

        '
    - pattern: '$SVG = $REQ.params.$PARAM

        '
    - pattern: '$SVG = $REQ.$ANY[$PARAM]

        '
  metadata:
    cwe: 'CWE-79: Improper Neutralization of Input During Web Page Generation (''Cross-site
      Scripting'')'
    owasp: A03:2021 - Injection
    category: security
    technology:
    - javascript
    - typescript
    - nodejs
    likelihood: HIGH
    impact: HIGH
    confidence: MEDIUM
    references:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-37383
