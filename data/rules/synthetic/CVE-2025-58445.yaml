rules:
- id: synthetic-cve202558445
  languages:
  - javascript
  - typescript
  severity: ERROR
  message: "Exposici\xF3n de metadatos internos de compilaci\xF3n y versi\xF3n a trav\xE9\
    s de un endpoint p\xFAblico. Esta pr\xE1ctica facilita el fingerprinting de la\
    \ aplicaci\xF3n (nombre del servicio, versi\xF3n exacta, hash de commit, fecha\
    \ de build, versi\xF3n de runtime, SO/arquitectura y dependencias), lo que puede\
    \ ser aprovechado por un atacante para seleccionar exploits espec\xEDficos o preparar\
    \ ataques dirigidos (CVE-2025-58445). Limita la informaci\xF3n expuesta en endpoints\
    \ de salud/estado a lo estrictamente necesario para monitoreo.\n"
  patterns:
  - pattern-either:
    - pattern: "const $BUILDINFO = {\n  ...\n};\n"
    - pattern: "$APP.$METHOD($ROUTE, ($REQ, $RES) => {\n  ...\n  $RES.json({\n   \
        \ ...,\n    $KEY: $BUILDINFO,\n    ...\n  });\n});\n"
  - pattern-inside: 'const $APP = require(''express'')();

      ...

      '
  - pattern-inside: "$APP.$METHOD($ROUTE, ($REQ, $RES) => {\n  ...\n});\n"
  - metavariable-pattern:
      metavariable: $ROUTE
      pattern: '''/status''

        '
  metadata:
    cve: CVE-2025-58445
    source: CISA_KEV
    category: security
    technology:
    - express
    references:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-58445
    description: "Detecci\xF3n de endpoints de estado/health en aplicaciones Express\
      \ que exponen metadatos internos de build y versi\xF3n (buildInfo) de forma\
      \ p\xFAblica, facilitando el fingerprinting y la selecci\xF3n de exploits dirigidos."
    likelihood: MEDIUM
    impact: HIGH
    confidence: MEDIUM
    cwe: 'CWE-20: Improper Input Validation'
    owasp: A03:2021 - Injection
