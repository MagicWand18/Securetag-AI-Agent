rules:
  - id: synthetic-cve202558454
    languages: [javascript, typescript]
    severity: ERROR
    message: >
      Posible SQL Injection (CVE-2025-58454): se construye din치micamente una
      consulta SQL con datos controlados por el usuario (por ejemplo, req.query.id_memorando)
      mediante concatenaci칩n/interpolaci칩n de strings antes de pasarlos a mysql2.connection.query().
      Un atacante puede manipular el par치metro para alterar la consulta SQL, extraer o modificar datos.
      Usa consultas parametrizadas/preparadas en lugar de interpolar directamente los valores.
    metadata:
      cve: "CVE-2025-58454"
      source: "CISA_KEV"
      category: "security"
      technology: ["nodejs", "express", "mysql2"]
      likelihood: "HIGH"
      impact: "HIGH"
      confidence: "MEDIUM"
    patterns:
      - pattern-inside: |
          const express = require('express');
          ...
      - pattern-inside: |
          $APP = express();
          ...
      - pattern-inside: |
          $APP.$METHOD($ROUTE, ($REQ, $RES) => {
            ...
          });
      - pattern-inside: |
          $ID = $REQ.query.id_memorando;
          ...
      - pattern: |
          $SQL = `SELECT * FROM $TABLE WHERE id_memorando = ${$ID}`;
      - pattern-either:
          - pattern: |
              $CONN.query($SQL, ...);
          - pattern: |
              $CONN.query($SQL, ($ERR, $RESULTS) => {
                ...
              });
    fix: >
      Usa consultas parametrizadas, por ejemplo:
      const sql = 'SELECT * FROM despachos WHERE id_memorando = ?';
      connection.query(sql, [idMemorando], ...);