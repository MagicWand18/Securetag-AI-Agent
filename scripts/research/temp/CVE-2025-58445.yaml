rules:
  - id: synthetic-cve202558445
    languages: [javascript, typescript]
    severity: ERROR
    message: >
      Exposición de metadatos internos de compilación y versión a través de un endpoint público.
      Esta práctica facilita el fingerprinting de la aplicación (nombre del servicio, versión exacta,
      hash de commit, fecha de build, versión de runtime, SO/arquitectura y dependencias), lo que
      puede ser aprovechado por un atacante para seleccionar exploits específicos o preparar ataques
      dirigidos (CVE-2025-58445). Limita la información expuesta en endpoints de salud/estado a lo
      estrictamente necesario para monitoreo.
    patterns:
      - pattern-either:
          # Caso 1: objeto buildInfo (o similar) con metadatos internos
          - pattern: |
              const $BUILDINFO = {
                ...
              };
          # Caso 2: endpoint Express que expone buildInfo/metadata detallada vía res.json
          - pattern: |
              $APP.$METHOD($ROUTE, ($REQ, $RES) => {
                ...
                $RES.json({
                  ...,
                  $KEY: $BUILDINFO,
                  ...
                });
              });
      - pattern-inside: |
          const $APP = require('express')();
          ...
      - pattern-inside: |
          $APP.$METHOD($ROUTE, ($REQ, $RES) => {
            ...
          });
      - metavariable-pattern:
          metavariable: $ROUTE
          pattern: |
            '/status'
    metadata:
      cve: CVE-2025-58445
      source: CISA_KEV
      category: security
      technology:
        - express
      references:
        - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-58445
      description: >
        Detección de endpoints de estado/health en aplicaciones Express que exponen metadatos
        internos de build y versión (buildInfo) de forma pública, facilitando el fingerprinting
        y la selección de exploits dirigidos.