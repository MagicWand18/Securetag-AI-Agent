rules:
  - id: synthetic-cve202557761
    languages:
      - javascript
      - typescript
    message: >
      Posible SQL Injection (CVE-2025-57761): se está construyendo dinámicamente
      una sentencia SQL DELETE concatenando directamente datos controlados por el
      usuario (por ejemplo, req.query.id_funcionario) en la consulta. Un atacante
      puede inyectar código SQL arbitrario (p.ej. "1 OR 1=1") y manipular o borrar
      registros en la base de datos. Usa consultas parametrizadas/preparadas en
      lugar de concatenar valores en la cadena SQL.
    severity: ERROR
    patterns:
      - pattern-inside: |
          $DB = require('mysql2');
          ...
      - pattern-inside: |
          $APP.$METHOD($ROUTE, ($REQ, $RES) => {
            ...
          });
      - pattern: |
          $DB_CONN.query($SQL, ($ERR, $RESULT) => {
            ...
          });
      - pattern: |
          const $SQL = `DELETE FROM $TABLE WHERE $COL = ${$PARAM}`;
    metadata:
      cwe: "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
      owasp: "A03:2021 - Injection"
      category: "security"
      technology:
        - javascript
        - typescript
        - nodejs
      likelihood: "HIGH"
      impact: "HIGH"
      confidence: "MEDIUM"
      references:
        - "https://nvd.nist.gov/vuln/detail/CVE-2025-57761"