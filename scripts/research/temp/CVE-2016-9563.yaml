rules:
  - id: synthetic-cve20169563
    languages: [javascript, typescript]
    severity: ERROR
    message: >
      Posible vulnerabilidad XXE (XML External Entity) al parsear XML controlado por el usuario
      con libxmljs sin deshabilitar entidades externas. Esto puede permitir a un atacante leer
      archivos locales o interactuar con recursos internos (SSRF), similar a CVE-2016-9563
      (alta probabilidad de explotación: 58.4%). Valida y sanitiza el XML de entrada y deshabilita
      la resolución de entidades externas antes de parsear.
    metadata:
      cve: "CVE-2016-9563"
      source: "CISA_KEV"
      category: security
      technology: [nodejs, libxmljs]
      vulnerability: xxe
    patterns:
      - pattern-inside: |
          const $LIB = require('libxmljs');
          ...
      - pattern-either:
          - pattern: $LIB.parseXml($X)
          - pattern: $LIB.parseXmlString($X)
    fix: >
      Usa opciones de configuración seguras de libxmljs (por ejemplo, deshabilitando entidades
      externas) o una biblioteca que no permita XXE por defecto. Asegúrate de no parsear
      directamente XML controlado por el usuario sin validación ni endurecimiento de la
      configuración del parser.