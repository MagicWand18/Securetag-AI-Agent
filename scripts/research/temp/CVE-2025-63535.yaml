rules:
  - id: synthetic-cve202563535
    languages:
      - javascript
      - typescript
    severity: ERROR
    message: >
      Posible SQL Injection (CVE-2025-63535): se construye una consulta SQL
      concatenando directamente datos controlados por el usuario (por ejemplo,
      req.body.search) en una cadena SQL usada por mysql2/db.query. Un atacante
      puede inyectar payloads como `'A+' OR '1'='1` para eludir controles de
      autenticación/búsqueda y acceder o modificar datos sensibles. Usa
      consultas parametrizadas/prepared statements en lugar de concatenación.
    metadata:
      cwe: "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
      owasp: "A03:2021 - Injection"
      category: "security"
      technology:
        - javascript
        - typescript
        - nodejs
      likelihood: "HIGH"
      impact: "HIGH"
      confidence: "MEDIUM"
      references:
        - "https://nvd.nist.gov/vuln/detail/CVE-2025-63535"
    patterns:
      - pattern-inside: |
          const $DB = require('mysql2');
          ...
      - pattern-inside: |
          $DB.$CREATECONN(...);
          ...
      - pattern-either:
          # mysql2: db.query(sql, ...)
          - pattern: |
              $CONN.query($SQL, ...);
          # mysql2: connection.execute(sql, ...)
          - pattern: |
              $CONN.execute($SQL, ...);
      - pattern: |
          const $SQL = $Q + $X;
      - pattern-not: |
          const $SQL = "...";