rules:
  - id: synthetic-cve202527915
    languages:
      - javascript
      - typescript
    severity: ERROR
    message: >
      Posible XSS al incrustar directamente contenido de archivos ICS en HTML
      sin sanitización, similar a CVE-2025-27915. Un atacante puede controlar
      campos como DESCRIPTION en el ICS e inyectar HTML/JS que se renderiza
      en el navegador, permitiendo ejecución de código arbitrario.
    metadata:
      cwe: "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
      owasp: "A03:2021 - Injection"
      category: "security"
      technology:
        - javascript
        - typescript
        - nodejs
      likelihood: "HIGH"
      impact: "HIGH"
      confidence: "MEDIUM"
      references:
        - "https://nvd.nist.gov/vuln/detail/CVE-2025-27915"
    patterns:
      - pattern-inside: |
          $APP.$METHOD($ROUTE, ($REQ, $RES) => {
            ...
          })
      - pattern: |
          const $ICS_CONTENT = $FS.readFileSync($PATH, 'utf8');
      - pattern: |
          const $DESC = $ICS_CONTENT.match(/DESCRIPTION:(.*)/);
      - pattern: |
          const $DESC_HTML = $DESC ? $DESC[1] : $FALLBACK;
      - pattern: |
          const $HTML = `
            ...
            ${$DESC_HTML}
            ...
          `;
      - pattern: |
          $RES.send($HTML);